{"version":3,"sources":["utils/image.ts","utils/time.ts","utils/contentAwareResizer.ts","components/EnergyMap.tsx","components/Seams.tsx","assets/02.jpg","components/Button.tsx","components/FileSelector.tsx","components/Checkbox.tsx","components/Progress.tsx","components/Input.tsx","components/FadeIn.tsx","components/Mask.tsx","components/ImageResizer.tsx","components/RootLayout.tsx","components/PageLayout.tsx","components/Row.tsx","components/Alert.tsx","components/ErrorBoundary.tsx","components/InteractivePostArea.tsx","components/HyperLink.tsx","components/App.tsx","constants/links.ts","constants/siteMeta.ts","index.tsx"],"names":["getPixel","img","x","i","y","width","data","subarray","setPixel","color","set","wait","ms","a","Promise","resolve","setTimeout","matrix","w","h","filler","Array","fill","map","getPixelEnergy","left","middle","right","mR","mG","mB","mA","lEnergy","lR","lG","lB","rEnergy","rR","rG","rB","Math","max","getPixelEnergyH","getPixelEnergyV","top","bottom","calculateEnergyMapH","energyMap","Infinity","calculateEnergyMapV","reCalculateEnergyMapH","seam","forEach","seamX","seamY","reCalculateEnergyMapV","findLowEnergySeamH","seamsMap","energy","coordinate","previous","minPrevEnergy","minPrevX","lastMinCoordinate","minSeamEnergy","lastMinX","currentSeam","push","prevMinCoordinates","prevMinX","findLowEnergySeamV","minPrevY","deleteSeamH","nextPixel","deleteSeamV","resizeImageWidth","args","toSize","onIteration","size","pxToRemove","Error","step","steps","resizeImageHeight","height","resizeImage","toWidth","toHeight","pxToRemoveH","pxToRemoveV","globalSteps","globalStep","onResizeIteration","onIterationArgs","onIterationImg","onIterationSize","normalizeEnergy","maxEnergy","maxNormalizedEnergy","floor","getMaxEnergy","EnergyMap","props","className","canvasRef","useRef","useEffect","length","energyCanvas","current","energyCtx","getContext","imgData","getImageData","normalizedEnergyMap","normalizedMap","normalizeEnergyMap","norm","putImageData","ref","Seams","seams","seamsCanvas","seamsCtx","fillStyle","fillRect","BUTTON_KIND_PRIMARY","BUTTON_KIND_SECONDARY","Button","children","onClick","disabled","title","undefined","startEnhancer","style","kind","disabledClasses","kindClasses","classes","separator","type","FileSelector","onSelect","accept","capture","multiple","icon","FaFileImage","padding","onChange","event","files","target","Checkbox","checkboxRef","checked","Progress","progress","progressPercentage","min","ceil","barStyle","transition","Input","value","rest","FadeIn","Mask","lineColor","lineWidth","lineJoin","backgroundColor","revision","onDrawEndCallback","onDrawEnd","useState","isPainting","setIsPainting","mousePosition","setMousePosition","getCoordinates","canvas","pageX","offsetLeft","pageY","offsetTop","startPaint","useCallback","coordinates","paint","newMousePosition","originalMousePosition","context","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","drawLine","exitPaint","addEventListener","removeEventListener","clearRect","touchAction","maxScale","ImageResizer","withSeam","withEnergyMap","imgAuthor","setImgAuthor","imgAuthorURL","setImgAuthorURL","useNaturalSize","setUseNaturalSize","defaultImgSrc","imageSrc","setImageSrc","resizedImgSrc","setResizedImgSrc","setEnergyMap","originalImgSize","setOriginalImgSize","originalImgViewSize","setOriginalImgViewSize","workingImgSize","setWorkingImgSize","setSeams","isResizing","setIsResizing","setProgress","maskImgData","setMaskImgData","maskRevision","setMaskRevision","toWidthScale","setToWidthScale","toWidthScaleString","setToWidthScaleString","toHeightScale","setToHeightScale","toHeightScaleString","setToHeightScaleString","imgRef","onReset","nrgMap","ctx","srcImg","naturalWidth","naturalHeight","updateSize","window","imgAuthorLink","href","fontWeight","rel","marginTop","originalImageSizeText","maskControls","border","outline","MdLayersClear","mask","zIndex","originalImage","FaRegHandPointer","src","alt","margin","workingImageScrollableText","workingImageSizeText","workingImage","resultImageSizeText","resultImage","debugEnergyMap","resizerControls","imageURL","URL","createObjectURL","ratio","drawImage","wRatio","hRatio","imgXYtoMaskXY","imgX","imgY","iR","iG","iB","applyMask","then","toBlob","blob","imgUrl","ImShrink2","scale","parseInt","state","progressBar","RootLayout","PageLayout","Row","responsive","InfoAlert","ErrorAlert","alertIcons","BsFillInfoCircleFill","BiErrorCircle","alertClasses","Alert","ErrorBoundary","hasError","error","errorInfo","console","this","setState","React","Component","InteractivePostArea","titleElement","HyperLink","link","hoverClassName","formatted","url","commonClasses","caption","App","algorithmBlogPostLink","FaPencilAlt","gitHubLink","AiFillGithub","algorithmPaperLink","RiFileList2Line","maxWidth","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5de11572.chunk.js","sourcesContent":["export type Color = [r: number, g: number, b: number, a: number] | Uint8ClampedArray;\n\nexport type Coordinate = { x: number, y: number };\n\nexport const getPixel = (img: ImageData, { x, y }: Coordinate): Color => {\n  const i = y * img.width + x;\n  return img.data.subarray(i * 4, i * 4 + 4);\n};\n\nexport const setPixel = (img: ImageData, { x, y }: Coordinate, color: Color): void => {\n  const i = y * img.width + x;\n  img.data.set(color, i * 4);\n};\n","export const wait = async (ms: number): Promise<void> => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n","/* eslint-disable no-await-in-loop, no-param-reassign, object-curly-newline */\nimport {\n  Color,\n  Coordinate,\n  getPixel,\n  setPixel,\n} from './image';\nimport { wait } from './time';\n\nexport type Seam = Coordinate[];\nexport type EnergyMap = number[][];\n\ntype SeamMeta = {\n  energy: number,\n  coordinate: Coordinate,\n  previous: Coordinate | null,\n};\n\nexport type ImageSize = { w: number, h: number };\n\nexport type OnIterationArgs = {\n  seam: Seam,\n  img: ImageData,\n  size: ImageSize,\n  energyMap: EnergyMap,\n  step: number,\n  steps: number,\n};\n\n// If pixel's alpha is lower than the threshold this pixel is going to have\n// the lowest energy and thus is a candidate for deletion.\nexport const ALPHA_DELETE_THRESHOLD = 244;\n\nexport const MAX_WIDTH_LIMIT = 1500;\nexport const MAX_HEIGHT_LIMIT = 1500;\n\nconst getPixelDeleteEnergy = (): number => {\n  const numColors = 3;\n  const maxColorDistance = 255;\n  const numNeighbors = 2;\n  const multiplier = 2;\n  const maxSeamSize = Math.max(MAX_WIDTH_LIMIT, MAX_HEIGHT_LIMIT);\n  return -1 * multiplier * numNeighbors * maxSeamSize * numColors * (maxColorDistance ** 2);\n};\n\nconst matrix = <T>(w: number, h: number, filler: T): T[][] => {\n  return new Array(h)\n    .fill(null)\n    .map(() => {\n      return new Array(w).fill(filler);\n    });\n};\n\nconst getPixelEnergy = (left: Color | null, middle: Color, right: Color | null): number => {\n  const [mR, mG, mB, mA] = middle;\n\n  let lEnergy = 0;\n  if (left) {\n    const [lR, lG, lB] = left;\n    lEnergy = (lR - mR) ** 2 + (lG - mG) ** 2 + (lB - mB) ** 2;\n  }\n\n  let rEnergy = 0;\n  if (right) {\n    const [rR, rG, rB] = right;\n    rEnergy = (rR - mR) ** 2 + (rG - mG) ** 2 + (rB - mB) ** 2;\n  }\n\n  return mA > ALPHA_DELETE_THRESHOLD ? (lEnergy + rEnergy) : getPixelDeleteEnergy();\n};\n\nconst getPixelEnergyH = (img: ImageData, { w }: ImageSize, { x, y }: Coordinate): number => {\n  const left = (x - 1) >= 0 ? getPixel(img, { x: x - 1, y }) : null;\n  const middle = getPixel(img, { x, y });\n  const right = (x + 1) < w ? getPixel(img, { x: x + 1, y }) : null;\n  return getPixelEnergy(left, middle, right);\n};\n\nconst getPixelEnergyV = (img: ImageData, { h }: ImageSize, { x, y }: Coordinate): number => {\n  const top = (y - 1) >= 0 ? getPixel(img, { x, y: y - 1 }) : null;\n  const middle = getPixel(img, { x, y });\n  const bottom = (y + 1) < h ? getPixel(img, { x, y: y + 1 }) : null;\n  return getPixelEnergy(top, middle, bottom);\n};\n\nconst calculateEnergyMapH = (img: ImageData, { w, h }: ImageSize): EnergyMap => {\n  const energyMap: number[][] = matrix<number>(w, h, Infinity);\n  for (let y = 0; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      energyMap[y][x] = getPixelEnergyH(img, { w, h }, { x, y });\n    }\n  }\n  return energyMap;\n};\n\nconst calculateEnergyMapV = (img: ImageData, { w, h }: ImageSize): EnergyMap => {\n  const energyMap: number[][] = matrix<number>(w, h, Infinity);\n  for (let y = 0; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      energyMap[y][x] = getPixelEnergyV(img, { w, h }, { x, y });\n    }\n  }\n  return energyMap;\n};\n\nconst reCalculateEnergyMapH = (\n  img: ImageData,\n  { w, h }: ImageSize,\n  energyMap: EnergyMap,\n  seam: Seam,\n): EnergyMap => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    // Deleting the seam from the energy map.\n    for (let x = seamX; x < (w - 1); x += 1) {\n      energyMap[seamY][x] = energyMap[seamY][x + 1];\n    }\n    // Recalculating the energy pixels around the deleted seam.\n    energyMap[seamY][seamX] = getPixelEnergyH(img, { w, h }, { x: seamX, y: seamY });\n  });\n  return energyMap;\n};\n\nconst reCalculateEnergyMapV = (\n  img: ImageData,\n  { w, h }: ImageSize,\n  energyMap: EnergyMap,\n  seam: Seam,\n): EnergyMap => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    // Deleting the seam from the energy map.\n    for (let y = seamY; y < (h - 1); y += 1) {\n      energyMap[y][seamX] = energyMap[y + 1][seamX];\n    }\n    // Recalculating the energy pixels around the deleted seam.\n    energyMap[seamY][seamX] = getPixelEnergyV(img, { w, h }, { x: seamX, y: seamY });\n  });\n  return energyMap;\n};\n\nconst findLowEnergySeamH = (energyMap: EnergyMap, { w, h }: ImageSize): Seam => {\n  const seamsMap: (SeamMeta | null)[][] = matrix<SeamMeta | null>(w, h, null);\n\n  // Populate the first row of the map.\n  for (let x = 0; x < w; x += 1) {\n    const y = 0;\n    seamsMap[y][x] = {\n      energy: energyMap[y][x],\n      coordinate: { x, y },\n      previous: null,\n    };\n  }\n\n  // Populate the rest of the rows.\n  for (let y = 1; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      // Find top adjacent cell with minimum energy.\n      let minPrevEnergy = Infinity;\n      let minPrevX: number = x;\n      for (let i = (x - 1); i <= (x + 1); i += 1) {\n        // @ts-ignore\n        if (i >= 0 && i < w && seamsMap[y - 1][i].energy < minPrevEnergy) {\n          // @ts-ignore\n          minPrevEnergy = seamsMap[y - 1][i].energy;\n          minPrevX = i;\n        }\n      }\n\n      // Update the current cell.\n      seamsMap[y][x] = {\n        energy: minPrevEnergy + energyMap[y][x],\n        coordinate: { x, y },\n        previous: { x: minPrevX, y: y - 1 },\n      };\n    }\n  }\n\n  // Find where the minimum energy seam ends.\n  let lastMinCoordinate: Coordinate | null = null;\n  let minSeamEnergy = Infinity;\n  for (let x = 0; x < w; x += 1) {\n    const y = h - 1;\n    // @ts-ignore\n    if (seamsMap[y][x].energy < minSeamEnergy) {\n      // @ts-ignore\n      minSeamEnergy = seamsMap[y][x].energy;\n      lastMinCoordinate = { x, y };\n    }\n  }\n\n  // Find the minimal energy seam.\n  const seam: Seam = [];\n  if (!lastMinCoordinate) {\n    return seam;\n  }\n\n  const { x: lastMinX, y: lastMinY } = lastMinCoordinate;\n\n  let currentSeam = seamsMap[lastMinY][lastMinX];\n  while (currentSeam) {\n    seam.push(currentSeam.coordinate);\n    const prevMinCoordinates = currentSeam.previous;\n    if (!prevMinCoordinates) {\n      currentSeam = null;\n    } else {\n      const { x: prevMinX, y: prevMinY } = prevMinCoordinates;\n      currentSeam = seamsMap[prevMinY][prevMinX];\n    }\n  }\n\n  return seam;\n};\n\nconst findLowEnergySeamV = (energyMap: EnergyMap, { w, h }: ImageSize): Seam => {\n  const seamsMap: (SeamMeta | null)[][] = matrix<SeamMeta | null>(w, h, null);\n\n  // Populate the first column of the map.\n  for (let y = 0; y < h; y += 1) {\n    const x = 0;\n    seamsMap[y][x] = {\n      energy: energyMap[y][x],\n      coordinate: { x, y },\n      previous: null,\n    };\n  }\n\n  // Populate the rest of the columns.\n  for (let x = 1; x < w; x += 1) {\n    for (let y = 0; y < h; y += 1) {\n      // Find left adjacent cell with minimum energy.\n      let minPrevEnergy = Infinity;\n      let minPrevY: number = y;\n      for (let i = (y - 1); i <= (y + 1); i += 1) {\n        // @ts-ignore\n        if (i >= 0 && i < h && seamsMap[i][x - 1].energy < minPrevEnergy) {\n          // @ts-ignore\n          minPrevEnergy = seamsMap[i][x - 1].energy;\n          minPrevY = i;\n        }\n      }\n\n      // Update the current cell.\n      seamsMap[y][x] = {\n        energy: minPrevEnergy + energyMap[y][x],\n        coordinate: { x, y },\n        previous: { x: x - 1, y: minPrevY },\n      };\n    }\n  }\n\n  // Find where the minimum energy seam ends.\n  let lastMinCoordinate: Coordinate | null = null;\n  let minSeamEnergy = Infinity;\n  for (let y = 0; y < h; y += 1) {\n    const x = w - 1;\n    // @ts-ignore\n    if (seamsMap[y][x].energy < minSeamEnergy) {\n      // @ts-ignore\n      minSeamEnergy = seamsMap[y][x].energy;\n      lastMinCoordinate = { x, y };\n    }\n  }\n\n  // Find the minimal energy seam.\n  const seam: Seam = [];\n  if (!lastMinCoordinate) {\n    return seam;\n  }\n\n  const { x: lastMinX, y: lastMinY } = lastMinCoordinate;\n\n  let currentSeam = seamsMap[lastMinY][lastMinX];\n  while (currentSeam) {\n    seam.push(currentSeam.coordinate);\n    const prevMinCoordinates = currentSeam.previous;\n    if (!prevMinCoordinates) {\n      currentSeam = null;\n    } else {\n      const { x: prevMinX, y: prevMinY } = prevMinCoordinates;\n      currentSeam = seamsMap[prevMinY][prevMinX];\n    }\n  }\n\n  return seam;\n};\n\nconst deleteSeamH = (img: ImageData, seam: Seam, { w }: ImageSize): void => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    for (let x = seamX; x < (w - 1); x += 1) {\n      const nextPixel = getPixel(img, { x: x + 1, y: seamY });\n      setPixel(img, { x, y: seamY }, nextPixel);\n    }\n  });\n};\n\nconst deleteSeamV = (img: ImageData, seam: Seam, { h }: ImageSize): void => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    for (let y = seamY; y < (h - 1); y += 1) {\n      const nextPixel = getPixel(img, { x: seamX, y: y + 1 });\n      setPixel(img, { x: seamX, y }, nextPixel);\n    }\n  });\n};\n\ntype ResizeAxisArgs = {\n  img: ImageData,\n  toSize: number,\n  size: ImageSize,\n  onIteration?: (args: OnIterationArgs) => Promise<void>,\n};\n\ntype ResizeImageArgs = {\n  img: ImageData,\n  toWidth: number,\n  toHeight: number,\n  onIteration?: (args: OnIterationArgs) => Promise<void>,\n};\n\nconst resizeImageWidth = async (args: ResizeAxisArgs): Promise<void> => {\n  const { img, toSize, onIteration, size } = args;\n\n  const pxToRemove = img.width - toSize;\n  if (pxToRemove < 0) {\n    throw new Error('Upsizing is not supported');\n  }\n\n  let energyMap: EnergyMap | null = null;\n  let seam: Seam | null = null;\n\n  for (let i = 0; i < pxToRemove; i += 1) {\n    energyMap = energyMap && seam\n      ? reCalculateEnergyMapH(img, size, energyMap, seam)\n      : calculateEnergyMapH(img, size);\n\n    seam = findLowEnergySeamH(energyMap, size);\n\n    deleteSeamH(img, seam, size);\n\n    if (onIteration) {\n      await onIteration({\n        energyMap,\n        seam,\n        img,\n        size,\n        step: i,\n        steps: pxToRemove,\n      });\n    }\n\n    size.w -= 1;\n\n    await wait(1);\n  }\n};\n\nconst resizeImageHeight = async (args: ResizeAxisArgs): Promise<void> => {\n  const { img, toSize, onIteration, size } = args;\n\n  const pxToRemove = img.height - toSize;\n  if (pxToRemove < 0) {\n    throw new Error('Upsizing is not supported');\n  }\n\n  let energyMap: EnergyMap | null = null;\n  let seam: Seam | null = null;\n\n  for (let i = 0; i < pxToRemove; i += 1) {\n    energyMap = energyMap && seam\n      ? reCalculateEnergyMapV(img, size, energyMap, seam)\n      : calculateEnergyMapV(img, size);\n\n    seam = findLowEnergySeamV(energyMap, size);\n\n    deleteSeamV(img, seam, size);\n\n    if (onIteration) {\n      await onIteration({\n        energyMap,\n        seam,\n        img,\n        size,\n        step: i,\n        steps: pxToRemove,\n      });\n    }\n\n    size.h -= 1;\n\n    await wait(1);\n  }\n};\n\nexport const resizeImage = async (args: ResizeImageArgs): Promise<void> => {\n  const {\n    img,\n    toWidth,\n    toHeight,\n    onIteration,\n  } = args;\n\n  const pxToRemoveH = img.width - toWidth;\n  const pxToRemoveV = img.height - toHeight;\n\n  const size: ImageSize = { w: img.width, h: img.height };\n\n  const globalSteps = pxToRemoveH + pxToRemoveV;\n  let globalStep = 0;\n\n  const onResizeIteration = async (onIterationArgs: OnIterationArgs): Promise<void> => {\n    const {\n      seam,\n      img: onIterationImg,\n      size: onIterationSize,\n      energyMap,\n    } = onIterationArgs;\n\n    globalStep += 1;\n\n    if (!onIteration) {\n      return;\n    }\n\n    await onIteration({\n      seam,\n      img: onIterationImg,\n      size: onIterationSize,\n      energyMap,\n      step: globalStep,\n      steps: globalSteps,\n    });\n  };\n\n  await resizeImageWidth({ img, toSize: toWidth, onIteration: onResizeIteration, size });\n  await resizeImageHeight({ img, toSize: toHeight, onIteration: onResizeIteration, size });\n};\n","import React, { useRef, useEffect } from 'react';\nimport { setPixel } from '../utils/image';\nimport { EnergyMap as EnergyMapType } from '../utils/contentAwareResizer';\n\ntype EnergyMapProps = {\n  energyMap: EnergyMapType | null,\n  width: number,\n  height: number,\n  className?: string,\n};\n\nconst normalizeEnergy = (\n  energy: number,\n  maxEnergy: number,\n  maxNormalizedEnergy: number,\n): number => {\n  return Math.floor((energy / maxEnergy) * maxNormalizedEnergy);\n};\n\nconst getMaxEnergy = (\n  energyMap: EnergyMapType,\n  width: number,\n  height: number,\n): number => {\n  let maxEnergy = 0;\n  for (let y = 0; y < height; y += 1) {\n    for (let x = 0; x < width; x += 1) {\n      maxEnergy = Math.max(maxEnergy, energyMap[y][x]);\n    }\n  }\n\n  return maxEnergy;\n};\n\nconst normalizeEnergyMap = (\n  energyMap: EnergyMapType,\n  width: number,\n  height: number,\n  maxNormalizedEnergy = 255,\n): number[][] => {\n  const maxEnergy = getMaxEnergy(energyMap, width, height);\n\n  const normalizedMap = new Array(height)\n    .fill(null)\n    .map(() => {\n      return new Array(width).fill(Infinity);\n    });\n\n  for (let y = 0; y < height; y += 1) {\n    for (let x = 0; x < width; x += 1) {\n      normalizedMap[y][x] = normalizeEnergy(energyMap[y][x], maxEnergy, maxNormalizedEnergy);\n    }\n  }\n\n  return normalizedMap;\n};\n\nconst EnergyMap = (props: EnergyMapProps): React.ReactElement => {\n  const {\n    energyMap,\n    className,\n    width,\n    height,\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (!energyMap || !energyMap.length || !energyMap[0].length) {\n      return;\n    }\n    const energyCanvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!energyCanvas) {\n      return;\n    }\n    const energyCtx: CanvasRenderingContext2D | null = energyCanvas.getContext('2d');\n    if (!energyCtx) {\n      return;\n    }\n\n    energyCanvas.width = width;\n    energyCanvas.height = height;\n\n    const imgData: ImageData = energyCtx.getImageData(0, 0, width, height);\n\n    const normalizedEnergyMap = normalizeEnergyMap(energyMap, width, height);\n\n    for (let y = 0; y < height; y += 1) {\n      for (let x = 0; x < width; x += 1) {\n        const norm = normalizedEnergyMap[y][x];\n        setPixel(imgData, { x, y }, [norm, norm, norm, 255]);\n      }\n    }\n\n    energyCtx.putImageData(imgData, 0, 0);\n  }, [energyMap, width, height]);\n\n  return (\n    <canvas ref={canvasRef} className={className} />\n  );\n};\n\nexport default EnergyMap;\n","import React, { useRef, useEffect } from 'react';\nimport { Seam } from '../utils/contentAwareResizer';\nimport { Coordinate } from '../utils/image';\n\ntype SeamProps = {\n  seams: Seam[],\n  width: number,\n  height: number,\n  className?: string,\n};\n\nconst Seams = (props: SeamProps): React.ReactElement => {\n  const {\n    seams,\n    width,\n    height,\n    className = '',\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (!seams || !seams.length || !seams[0]) {\n      return;\n    }\n    const seamsCanvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!seamsCanvas) {\n      return;\n    }\n    const seamsCtx: CanvasRenderingContext2D | null = seamsCanvas.getContext('2d');\n    if (!seamsCtx) {\n      return;\n    }\n\n    seamsCanvas.width = width;\n    seamsCanvas.height = height;\n\n    seamsCtx.fillStyle = 'rgba(255, 255, 255, 1)';\n    seams[0].forEach(({ x, y }: Coordinate) => {\n      seamsCtx.fillRect(x, y, 1, 1);\n    });\n  }, [seams, width, height]);\n\n  return (\n    <canvas ref={canvasRef} className={className} />\n  );\n};\n\nexport default Seams;\n","export default __webpack_public_path__ + \"static/media/02.044e70cf.jpg\";","import React, { CSSProperties } from 'react';\n\ntype ButtonKind = 'primary' | 'secondary';\n\nexport const BUTTON_KIND_PRIMARY: ButtonKind = 'primary';\nexport const BUTTON_KIND_SECONDARY: ButtonKind = 'secondary';\n\nexport type ButtonProps = {\n  children: React.ReactNode,\n  onClick?: () => void,\n  className?: string,\n  disabled?: boolean,\n  title?: string | undefined,\n  startEnhancer?: React.ReactNode,\n  style?: CSSProperties,\n  kind?: ButtonKind,\n};\n\nconst Button = (props: ButtonProps): React.ReactElement => {\n  const {\n    children,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onClick = (): void => {},\n    disabled = false,\n    title = undefined,\n    startEnhancer = null,\n    style = {},\n    kind = BUTTON_KIND_PRIMARY,\n  } = props;\n\n  const defaultClasses = ' transition duration-200 ease-in-out flex flex-row items-center uppercase font-medium text-xs tracking-wider';\n\n  const disabledClasses: Record<ButtonKind, string> = {\n    [BUTTON_KIND_PRIMARY]: 'cursor-not-allowed bg-white text-gray-500 hover:bg-white hover:text-gray-500 border-gray-300',\n    [BUTTON_KIND_SECONDARY]: 'cursor-not-allowed bg-white text-gray-500 hover:bg-white hover:text-gray-500 border-gray-300',\n  };\n\n  const kindClasses: Record<ButtonKind, string> = {\n    [BUTTON_KIND_PRIMARY]: 'hover:bg-white hover:text-black py-2 px-3 rounded shadow-sm border border-solid border-white hover:border-gray-400 bg-black text-white',\n    [BUTTON_KIND_SECONDARY]: 'bg-white text-black py-2 px-3 rounded shadow-sm border border-solid hover:border-white border-gray-400 hover:bg-black hover:text-white',\n  };\n\n  const classes = `${defaultClasses} ${kindClasses[kind]} ${disabled ? disabledClasses[kind] : ''} ${className}`;\n\n  const separator = startEnhancer ? (\n    <span className=\"w-2\" />\n  ) : null;\n\n  return (\n    <button\n      className={classes}\n      onClick={onClick}\n      type=\"button\"\n      disabled={disabled}\n      title={title}\n      style={style}\n    >\n      {startEnhancer}\n      {separator}\n      {children}\n    </button>\n  );\n};\n\nexport default Button;\n","import React, { ChangeEvent } from 'react';\nimport { FaFileImage } from '@react-icons/all-files/fa/FaFileImage';\nimport Button from './Button';\n\ntype FileSelectorProps = {\n  onSelect: (files: FileList | null) => void;\n  accept?: string, // i.e. 'image/png,image/jpeg'\n  capture?: 'user' | 'environment',\n  multiple?: boolean,\n  children: React.ReactNode,\n  disabled?: boolean,\n};\n\nconst FileSelector = (props: FileSelectorProps): React.ReactElement => {\n  const {\n    onSelect,\n    accept,\n    capture,\n    multiple = false,\n    disabled = false,\n    children,\n  } = props;\n\n  const onChange = (event: ChangeEvent): void => {\n    const { files } = (event.target as HTMLInputElement);\n    onSelect(files);\n  };\n\n  const icon = (\n    <div className=\"mr-2\">\n      <FaFileImage size={14} />\n    </div>\n  );\n\n  const disabledClasses = disabled ? 'cursor-not-allowed' : '';\n\n  /* eslint-disable jsx-a11y/label-has-associated-control */\n  return (\n    <Button style={{ padding: 0 }} disabled={disabled}>\n      <label className={`cursor-pointer py-2 px-3 flex uppercase font-medium text-xs tracking-wider ${disabledClasses}`}>\n        <input\n          type=\"file\"\n          accept={accept}\n          capture={capture}\n          onChange={onChange}\n          multiple={multiple}\n          className=\"hidden\"\n          disabled={disabled}\n        />\n        {icon}\n        {children}\n      </label>\n    </Button>\n  );\n};\n\nexport default FileSelector;\n","import React, { useRef } from 'react';\n\nexport type CheckboxProps = {\n  children: React.ReactNode,\n  onChange?: (state: boolean) => void,\n  className?: string,\n  disabled?: boolean,\n};\n\nconst Checkbox = (props: CheckboxProps): React.ReactElement => {\n  const {\n    children,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onChange = (): void => {},\n    disabled = false,\n  } = props;\n\n  const checkboxRef = useRef<HTMLInputElement>(null);\n\n  const disabledClasses = disabled ? 'cursor-not-allowed text-gray-500' : '';\n  const defaultClasses = 'flex items-center cursor-pointer';\n  const classes = `${defaultClasses} ${disabledClasses} ${className}`;\n\n  const onCheckboxChange = (): void => {\n    if (!checkboxRef.current) {\n      return;\n    }\n    onChange(checkboxRef.current.checked);\n  };\n\n  /* eslint-disable jsx-a11y/label-has-associated-control */\n  return (\n    <label className={classes}>\n      <input\n        type=\"checkbox\"\n        disabled={disabled}\n        onChange={onCheckboxChange}\n        ref={checkboxRef}\n      />\n      <div className=\"ml-2\">{children}</div>\n    </label>\n  );\n};\n\nexport default Checkbox;\n","import React, { CSSProperties } from 'react';\n\ntype ZeroToOne = number;\n\nexport type CheckboxProps = {\n  progress: ZeroToOne,\n};\n\nconst Progress = (props: CheckboxProps): React.ReactElement => {\n  const { progress } = props;\n\n  const progressPercentage = Math.min(Math.ceil(100 * progress), 100);\n  const barStyle: CSSProperties = {\n    width: `${progressPercentage}%`,\n    transition: 'width 0.5s',\n  };\n\n  return (\n    <div className=\"bg-gray-100 h-0.5 overflow-hidden flex flex-row justify-start items-center rounded\">\n      <div className=\"bg-black w-36 h-full transition duration-500 ease-in-out rounded transition\" style={barStyle} />\n    </div>\n  );\n};\n\nexport default Progress;\n","import React, { ChangeEvent } from 'react';\n\nexport type InputProps = {\n  onChange?: (value: string) => void,\n  className?: string,\n  disabled?: boolean,\n  value?: string | ReadonlyArray<string> | number,\n};\n\nconst Input = (props: InputProps): React.ReactElement => {\n  const {\n    disabled = false,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onChange = (): void => {},\n    value,\n    ...rest\n  } = props;\n\n  const disabledClasses = disabled ? 'border-gray-300 text-gray-500 cursor-not-allowed' : '';\n  const defaultClasses = 'border border-solid border-black rounded px-2 py-1 text-sm';\n  const classes = `${defaultClasses} ${disabledClasses} ${className}`;\n\n  const onInputChange = (event: ChangeEvent<HTMLInputElement>): void => {\n    onChange(event.target.value);\n  };\n\n  return (\n    <div className=\"flex flex-row justify-center items-center\">\n      <input\n        disabled={disabled}\n        onChange={onInputChange}\n        className={classes}\n        value={value}\n        {...rest}\n      />\n    </div>\n  );\n};\n\nexport default Input;\n","import React from 'react';\n\nimport './FadeIn.css';\n\ntype FadeInProps = {\n  children: React.ReactNode,\n  className?: string,\n};\n\nconst FadeIn = (props: FadeInProps): React.ReactElement => {\n  const { children, className = '' } = props;\n\n  return (\n    <div className={`custom-fade-in-opacity ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nexport default FadeIn;\n","/* eslint-disable @typescript-eslint/no-empty-function */\nimport React, {\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nconst defaultBackgroundColor = 'rgba(0, 0, 0, 0)';\n\ntype MouseCoordinate = {\n  x: number,\n  y: number,\n};\n\ntype MaskProps = {\n  disabled?: boolean,\n  width?: number,\n  height?: number,\n  lineWidth?: number,\n  lineJoin?: CanvasLineJoin,\n  lineColor?: string,\n  backgroundColor?: string,\n  revision?: number,\n  onDrawEnd?: (imageData: ImageData) => void,\n};\n\nconst Mask = (props: MaskProps): React.ReactElement => {\n  const {\n    disabled = false,\n    width = 200,\n    height = 200,\n    lineColor = 'rgba(255, 0, 0, 1)',\n    lineWidth = 16,\n    lineJoin = 'round',\n    backgroundColor = defaultBackgroundColor,\n    revision = 0,\n    onDrawEnd: onDrawEndCallback,\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isPainting, setIsPainting] = useState<boolean>(false);\n  const [mousePosition, setMousePosition] = useState<MouseCoordinate | null>(null);\n\n  const getCoordinates = (event: MouseEvent): MouseCoordinate | null => {\n    if (!canvasRef.current) {\n      return null;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    return {\n      x: event.pageX - canvas.offsetLeft,\n      y: event.pageY - canvas.offsetTop,\n    };\n  };\n\n  const startPaint = useCallback((event: MouseEvent) => {\n    if (disabled) {\n      return;\n    }\n    const coordinates = getCoordinates(event);\n    if (coordinates) {\n      setMousePosition(coordinates);\n      setIsPainting(true);\n    }\n  }, [disabled]);\n\n  const paint = useCallback(\n    (event: MouseEvent) => {\n      const drawLine = (\n        originalMousePosition: MouseCoordinate,\n        newMousePosition: MouseCoordinate,\n      ): void => {\n        if (!canvasRef.current || disabled) {\n          return;\n        }\n        const canvas: HTMLCanvasElement = canvasRef.current;\n        const context = canvas.getContext('2d');\n        if (context) {\n          context.strokeStyle = lineColor;\n          context.lineJoin = lineJoin;\n          context.lineWidth = lineWidth;\n          context.beginPath();\n          context.moveTo(originalMousePosition.x, originalMousePosition.y);\n          context.lineTo(newMousePosition.x, newMousePosition.y);\n          context.closePath();\n          context.stroke();\n        }\n      };\n\n      if (isPainting) {\n        const newMousePosition = getCoordinates(event);\n        if (mousePosition && newMousePosition) {\n          drawLine(mousePosition, newMousePosition);\n          setMousePosition(newMousePosition);\n        }\n      }\n    },\n    [isPainting, mousePosition, lineColor, lineJoin, lineWidth, disabled],\n  );\n\n  const exitPaint = useCallback(() => {\n    const onDrawEnd = (): void => {\n      if (!canvasRef.current || disabled) {\n        return;\n      }\n\n      const canvas: HTMLCanvasElement = canvasRef.current;\n      const context = canvas.getContext('2d');\n\n      // Call a callback.\n      if (onDrawEndCallback && context) {\n        onDrawEndCallback(\n          context.getImageData(0, 0, canvas.width, canvas.height),\n        );\n      }\n    };\n\n    onDrawEnd();\n    setIsPainting(false);\n    setMousePosition(null);\n  }, [onDrawEndCallback, disabled]);\n\n  // Effect for MouseDown.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mousedown', startPaint);\n    // @ts-ignore\n    canvas.addEventListener('touchstart', startPaint);\n\n    return (): void => {\n      canvas.removeEventListener('mousedown', startPaint);\n      // @ts-ignore\n      canvas.removeEventListener('touchstart', startPaint);\n    };\n  }, [startPaint]);\n\n  // Effect for MouseMove.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mousemove', paint);\n    // @ts-ignore\n    canvas.addEventListener('touchmove', paint);\n\n    return (): void => {\n      canvas.removeEventListener('mousemove', paint);\n      // @ts-ignore\n      canvas.removeEventListener('touchmove', paint);\n    };\n  }, [paint]);\n\n  // Effect for MouseUp and MouseLeave.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mouseup', exitPaint);\n    canvas.addEventListener('mouseleave', exitPaint);\n    canvas.addEventListener('touchend', exitPaint);\n    canvas.addEventListener('touchcancel', exitPaint);\n\n    return (): void => {\n      canvas.removeEventListener('mouseup', exitPaint);\n      canvas.removeEventListener('mouseleave', exitPaint);\n      canvas.removeEventListener('touchend', exitPaint);\n      canvas.removeEventListener('touchcancel', exitPaint);\n    };\n  }, [exitPaint]);\n\n  // Effect for filling a canvases with color.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.fillStyle = backgroundColor;\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n  }, [backgroundColor]);\n\n  // Effect to cleanup the canvas.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.fillStyle = backgroundColor;\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n  }, [revision, backgroundColor]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={width}\n      height={height}\n      style={{ touchAction: 'none' }}\n    />\n  );\n};\n\nexport default Mask;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { ImShrink2 } from '@react-icons/all-files/im/ImShrink2';\nimport { FaRegHandPointer } from '@react-icons/all-files/fa/FaRegHandPointer';\n\nimport {\n  EnergyMap as EnergyMapType,\n  Seam,\n  OnIterationArgs,\n  ImageSize,\n  resizeImage,\n  ALPHA_DELETE_THRESHOLD,\n  MAX_WIDTH_LIMIT,\n  MAX_HEIGHT_LIMIT,\n} from '../utils/contentAwareResizer';\nimport EnergyMap from './EnergyMap';\nimport Seams from './Seams';\nimport defaultImgSrc from '../assets/02.jpg';\nimport Button, { BUTTON_KIND_SECONDARY } from './Button';\nimport FileSelector from './FileSelector';\nimport Checkbox from './Checkbox';\nimport Progress from './Progress';\nimport Input from './Input';\nimport FadeIn from './FadeIn';\nimport Mask from './Mask';\nimport { Coordinate, getPixel, setPixel } from '../utils/image';\nimport { MdLayersClear } from '@react-icons/all-files/md/MdLayersClear';\n\nconst defaultWidthScale = 50;\nconst defaultHeightScale = 70;\nconst minScale = 1;\nconst maxScale = 100;\nconst maxWidthLimit = MAX_WIDTH_LIMIT;\nconst maxHeightLimit = MAX_HEIGHT_LIMIT;\n\ntype ImageResizerProps = {\n  withSeam?: boolean,\n  withEnergyMap?: boolean,\n};\n\nconst ImageResizer = (props: ImageResizerProps): React.ReactElement => {\n  const {\n    withSeam = false,\n    withEnergyMap = false,\n  } = props;\n\n  const [imgAuthor, setImgAuthor] = useState<string | null>('ian dooley');\n  const [imgAuthorURL, setImgAuthorURL] = useState<string | null>(\n    'https://unsplash.com/@sadswim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText',\n  );\n\n  const [useNaturalSize, setUseNaturalSize] = useState<boolean>(false);\n  const [imageSrc, setImageSrc] = useState<string>(defaultImgSrc);\n  const [resizedImgSrc, setResizedImgSrc] = useState<string | null>(null);\n  const [energyMap, setEnergyMap] = useState<EnergyMapType | null>(null);\n  const [originalImgSize, setOriginalImgSize] = useState<ImageSize | null>(null);\n  const [originalImgViewSize, setOriginalImgViewSize] = useState<ImageSize | null>(null);\n  const [workingImgSize, setWorkingImgSize] = useState<ImageSize | null>(null);\n  const [seams, setSeams] = useState<Seam[] | null>(null);\n  const [isResizing, setIsResizing] = useState<boolean>(false);\n  const [progress, setProgress] = useState<number>(0);\n  const [maskImgData, setMaskImgData] = useState<ImageData | null>(null);\n  const [maskRevision, setMaskRevision] = useState<number>(0);\n  const [toWidthScale, setToWidthScale] = useState<number>(defaultWidthScale);\n  const [toWidthScaleString, setToWidthScaleString] = useState<string | undefined>(`${defaultWidthScale}`);\n  const [toHeightScale, setToHeightScale] = useState<number>(defaultHeightScale);\n  const [toHeightScaleString, setToHeightScaleString] = useState<string | undefined>(`${defaultHeightScale}`);\n\n  const imgRef = useRef<HTMLImageElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const onUseOriginalSizeChange = (state: boolean): void => {\n    setUseNaturalSize(state);\n  };\n\n  const onReset = (): void => {\n    setResizedImgSrc(null);\n    setSeams(null);\n    setWorkingImgSize(null);\n    setEnergyMap(null);\n    setProgress(0);\n    setOriginalImgViewSize(null);\n  };\n\n  const onFileSelect = (files: FileList | null): void => {\n    if (!files || !files.length) {\n      return;\n    }\n    setImgAuthor(null);\n    setImgAuthorURL(null);\n    onReset();\n    const imageURL = URL.createObjectURL(files[0]);\n    setImageSrc(imageURL);\n  };\n\n  const onWidthSizeChange = (size: string | undefined): void => {\n    const radix = 10;\n    const scale = Math.max(Math.min(parseInt(size || '0', radix), maxScale), minScale);\n    if (size) {\n      setToWidthScaleString(`${scale}`);\n    } else {\n      setToWidthScaleString(size);\n    }\n    setToWidthScale(scale);\n  };\n\n  const onHeightSizeChange = (size: string | undefined): void => {\n    const radix = 10;\n    const scale = Math.max(Math.min(parseInt(size || '0', radix), maxScale), minScale);\n    if (size) {\n      setToHeightScaleString(`${scale}`);\n    } else {\n      setToHeightScaleString(size);\n    }\n    setToHeightScale(scale);\n  };\n\n  const onFinish = (): void => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const imageType = 'image/png';\n    canvasRef.current.toBlob((blob: Blob | null): void => {\n      if (!blob) {\n        return;\n      }\n      const imgUrl = URL.createObjectURL(blob);\n      setResizedImgSrc(imgUrl);\n      setIsResizing(false);\n    }, imageType);\n  };\n\n  const onClearMask = (): void => {\n    setMaskRevision(maskRevision + 1);\n  };\n\n  const onMaskDrawEnd = (imgData: ImageData): void => {\n    setMaskImgData(imgData);\n  };\n\n  const applyMask = (img: ImageData): void => {\n    if (!maskImgData) {\n      return;\n    }\n\n    const wRatio = maskImgData.width / img.width;\n    const hRatio = maskImgData.height / img.height;\n\n    const imgXYtoMaskXY = ({ x: imgX, y: imgY }: Coordinate): Coordinate => {\n      return {\n        x: Math.floor(imgX * wRatio),\n        y: Math.floor(imgY * hRatio),\n      };\n    };\n\n    for (let y = 0; y < img.height; y += 1) {\n      for (let x = 0; x < img.width; x += 1) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const [mR, mG, mB, mA] = getPixel(\n          maskImgData,\n          imgXYtoMaskXY({ x, y }),\n        );\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const [iR, iG, iB, iA] = getPixel(img, { x, y });\n        if (mA) {\n          setPixel(img, { x, y }, [iR, iG, iB, ALPHA_DELETE_THRESHOLD]);\n        }\n      }\n    }\n  };\n\n  const onIteration = async (args: OnIterationArgs): Promise<void> => {\n    const {\n      seam,\n      img,\n      energyMap: nrgMap,\n      size: { w, h },\n      step,\n      steps,\n    } = args;\n\n    const canvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    canvas.width = w;\n    canvas.height = h;\n\n    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    ctx.putImageData(img, 0, 0, 0, 0, w, h);\n\n    setEnergyMap(nrgMap);\n    setSeams([seam]);\n    setWorkingImgSize({ w, h });\n    setProgress(step / steps);\n  };\n\n  const onResize = (): void => {\n    const srcImg: HTMLImageElement | null = imgRef.current;\n    if (!srcImg) {\n      return;\n    }\n    const canvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    onReset();\n    setIsResizing(true);\n\n    let w = useNaturalSize ? srcImg.naturalWidth : srcImg.width;\n    let h = useNaturalSize ? srcImg.naturalHeight : srcImg.height;\n    const ratio = w / h;\n\n    setOriginalImgViewSize({\n      w: srcImg.width,\n      h: srcImg.height,\n    });\n\n    if (w > maxWidthLimit) {\n      w = maxWidthLimit;\n      h = Math.floor(w / ratio);\n    }\n\n    if (h > maxHeightLimit) {\n      h = maxHeightLimit;\n      w = Math.floor(h * ratio);\n    }\n\n    canvas.width = w;\n    canvas.height = h;\n\n    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    ctx.drawImage(srcImg, 0, 0, w, h);\n\n    const img: ImageData = ctx.getImageData(0, 0, w, h);\n\n    applyMask(img);\n\n    const toWidth = Math.floor((toWidthScale * w) / 100);\n    const toHeight = Math.floor((toHeightScale * h) / 100);\n\n    resizeImage({\n      img,\n      toWidth,\n      toHeight,\n      onIteration,\n    }).then(() => {\n      onFinish();\n    });\n  };\n\n  useEffect(() => {\n    const srcImg: HTMLImageElement | null = imgRef.current;\n    if (!srcImg) {\n      return;\n    }\n    srcImg.addEventListener('load', () => {\n      if (!imgRef.current) {\n        return;\n      }\n      setOriginalImgSize({\n        w: imgRef.current.naturalWidth,\n        h: imgRef.current.naturalHeight,\n      });\n      setOriginalImgViewSize({\n        w: imgRef.current.width,\n        h: imgRef.current.height,\n      });\n    });\n  }, []);\n\n  useEffect(() => {\n    function updateSize(): void {\n      if (!imgRef.current) {\n        return;\n      }\n      setOriginalImgViewSize({\n        w: imgRef.current.width,\n        h: imgRef.current.height,\n      });\n    }\n    window.addEventListener('resize', updateSize);\n    return (): void => {\n      window.removeEventListener('resize', updateSize);\n    };\n  }, []);\n\n  const imgAuthorLink = imgAuthor && imgAuthorURL ? (\n    <div className=\"text-xs text-gray-400 mt-2 flex justify-center items-center font-light\">\n      <div className=\"mr-1\">\n        Photo by\n      </div>\n      <a\n        href={imgAuthorURL}\n        style={{ color: '#aaa', fontWeight: 300 }}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {imgAuthor}\n      </a>\n    </div>\n  ) : null;\n\n  const seamsCanvas = withSeam && workingImgSize && seams ? (\n    <div style={{ marginTop: `-${workingImgSize.h}px` }}>\n      <Seams seams={seams} width={workingImgSize.w} height={workingImgSize.h} />\n    </div>\n  ) : null;\n\n  const originalImageSizeText = originalImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${originalImgSize.w} x ${originalImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const maskControls = (\n    <div>\n      <Button\n        onClick={onClearMask}\n        disabled={isResizing || !maskImgData}\n        kind={BUTTON_KIND_SECONDARY}\n        title=\"Clear mask\"\n        className=\"rounded-full\"\n        style={{ padding: '8px 8px', border: 0, outline: 'none' }}\n      >\n        <MdLayersClear size={16} />\n      </Button>\n    </div>\n  );\n\n  const mask = originalImgViewSize ? (\n    <div className=\"flex flex-col\" style={{ marginTop: `-${originalImgViewSize.h}px` }}>\n      <Mask\n        width={originalImgViewSize.w}\n        height={originalImgViewSize.h}\n        disabled={isResizing}\n        onDrawEnd={onMaskDrawEnd}\n        revision={maskRevision}\n      />\n      <div className=\"flex flex-row justify-end\" style={{ marginTop: '-36px', zIndex: 100 }}>\n        <div className=\"mr-1\">\n          {maskControls}\n        </div>\n      </div>\n    </div>\n  ) : null;\n\n  const originalImage = (\n    <FadeIn>\n      <div className=\"flex flex-row justify-center items-center mb-1 sm:mb-0\">\n        <div className=\"flex-1 sm:flex sm:flex-row sm:items-center\">\n          <div className=\"sm:flex-1\">\n            <b>Original image</b> {originalImageSizeText}\n          </div>\n          <div className=\"text-xs text-gray-400 flex flex-row items-center justify-self-end\">\n            <div className=\"mr-1\">\n              <FaRegHandPointer size={12} />\n            </div>\n            <div>\n              Mask to remove\n            </div>\n          </div>\n        </div>\n      </div>\n      <img src={imageSrc} alt=\"Original\" ref={imgRef} style={{ margin: 0 }} />\n      {mask}\n      {imgAuthorLink}\n    </FadeIn>\n  );\n\n  const workingImageScrollableText = (\n    workingImgSize?.w && originalImgViewSize?.w && workingImgSize.w > originalImgViewSize.w\n  ) ? <span className=\"text-xs text-gray-400 ml-4\">↔︎ scrollable</span> : null;\n\n  const workingImageSizeText = workingImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${workingImgSize.w} x ${workingImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const workingImage = (\n    <FadeIn className={`mb-6 ${resizedImgSrc || !energyMap ? 'hidden' : ''}`}>\n      <div><b>Resized image</b> {workingImageSizeText} {workingImageScrollableText}</div>\n      <div className=\"overflow-scroll\">\n        <canvas ref={canvasRef} />\n        {seamsCanvas}\n      </div>\n    </FadeIn>\n  );\n\n  const resultImageSizeText = workingImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${workingImgSize.w} x ${workingImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const resultImage = workingImgSize && resizedImgSrc ? (\n    <FadeIn className=\"mb-6\">\n      <div><b>Resized image</b> {resultImageSizeText}</div>\n      <img src={resizedImgSrc} width={workingImgSize.w} height={workingImgSize.h} alt=\"Resized\" style={{ margin: 0 }} />\n    </FadeIn>\n  ) : null;\n\n  const debugEnergyMap = withEnergyMap && workingImgSize ? (\n    <FadeIn className=\"mb-6\">\n      <div><b>Energy map</b></div>\n      <EnergyMap energyMap={energyMap} width={workingImgSize.w} height={workingImgSize.h} />\n      {seamsCanvas}\n    </FadeIn>\n  ) : null;\n\n  const resizerControls = (\n    <div className=\"flex flex-col justify-start items-start mb-1\">\n\n      <div className=\"mb-3 flex flex-row\">\n        <div className=\"mr-2\">\n          <FileSelector\n            onSelect={onFileSelect}\n            disabled={isResizing}\n            accept=\"image/png,image/jpeg\"\n          >\n            Choose image\n          </FileSelector>\n        </div>\n\n        <div>\n          <Button\n            onClick={onResize}\n            disabled={isResizing || !toWidthScaleString}\n            startEnhancer={<ImShrink2 size={14} />}\n          >\n            Resize\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row\">\n        <div className=\"mb-2 mr-6 flex flex-row items-center\">\n          <div className=\"text-xs mr-1\">Width</div>\n          <Input\n            onChange={onWidthSizeChange}\n            disabled={isResizing}\n            // @ts-ignore\n            type=\"number\"\n            min={minScale}\n            max={maxScale}\n            className=\"w-14 text-center\"\n            value={toWidthScaleString}\n          />\n          <div className=\"text-xs ml-1 mr-4\">%</div>\n\n          <div className=\"text-xs mr-1\">Height</div>\n          <Input\n            onChange={onHeightSizeChange}\n            disabled={isResizing}\n            // @ts-ignore\n            type=\"number\"\n            min={minScale}\n            max={maxScale}\n            className=\"w-14 text-center\"\n            value={toHeightScaleString}\n          />\n          <div className=\"text-xs ml-1\">%</div>\n        </div>\n\n        <div className=\"mb-2\">\n          <Checkbox disabled={isResizing} onChange={onUseOriginalSizeChange}>\n            <span className=\"text-xs\">\n              Higher quality <span className=\"text-gray-400\">(takes longer)</span>\n            </span>\n          </Checkbox>\n        </div>\n      </div>\n\n    </div>\n  );\n\n  const progressBar = (\n    <div className=\"mb-6\">\n      <Progress progress={progress} />\n    </div>\n  );\n\n  return (\n    <>\n      {resizerControls}\n      {progressBar}\n      {workingImage}\n      {resultImage}\n      {debugEnergyMap}\n      {originalImage}\n    </>\n  );\n};\n\nexport default ImageResizer;\n","import React from 'react';\n\ntype RootLayoutProps = {\n  children: React.ReactNode,\n};\n\nconst RootLayout = (props: RootLayoutProps): React.ReactElement => {\n  const { children } = props;\n  return (\n    <>\n      {children}\n    </>\n  );\n};\n\nexport default RootLayout;\n","import React from 'react';\n\ntype PageLayoutProps = {\n  children: React.ReactNode,\n};\n\nconst PageLayout = (props: PageLayoutProps): React.ReactElement | null => {\n  const { children } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  return (\n    <main className=\"flex flex-col items-center\">\n      <div className=\"max-w-screen-xl self-stretch m-auto w-full\">\n        <article className=\"px-6 sm:px-12 pt-6 pb-12\">\n          {children}\n        </article>\n      </div>\n    </main>\n  );\n};\n\nexport default PageLayout;\n","import React, { CSSProperties } from 'react';\n\ntype RowProps = {\n  children: React.ReactNode,\n  className?: string,\n  responsive?: boolean,\n  style?: CSSProperties,\n};\n\nconst Row = (props: RowProps): React.ReactElement | null => {\n  const {\n    children,\n    className = '',\n    responsive = false,\n    style = {},\n  } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  const classes = responsive ? 'flex flex-col sm:flex-row items-center' : 'flex flex-row items-center';\n\n  return (\n    <div style={style} className={`${classes} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nexport default Row;\n","import React from 'react';\nimport { BsFillInfoCircleFill } from '@react-icons/all-files/bs/BsFillInfoCircleFill';\nimport { BiErrorCircle } from '@react-icons/all-files/bi/BiErrorCircle';\n\nimport Row from './Row';\n\ntype AlertType = 'error' | 'info';\n\ntype AlertProps = {\n  type: AlertType,\n  children: React.ReactNode | null,\n};\n\ntype AlertIcons = Record<AlertType, React.ReactNode>;\n\ntype AlertClasses = Record<AlertType, string>;\n\nexport const InfoAlert: AlertType = 'info';\nexport const ErrorAlert: AlertType = 'error';\n\nconst alertIcons: AlertIcons = {\n  [InfoAlert]: <BsFillInfoCircleFill size={18} />,\n  [ErrorAlert]: <BiErrorCircle size={18} />,\n};\n\nconst alertClasses: AlertClasses = {\n  [InfoAlert]: 'text-blue-600 bg-blue-100',\n  [ErrorAlert]: 'text-red-600 bg-red-100',\n};\n\nconst Alert = (props: AlertProps): React.ReactElement | null => {\n  const { children, type } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  return (\n    <div className={`py-3 px-4 rounded-md ${alertClasses[type]}`}>\n      <Row>\n        <div className=\"mr-3\">\n          {alertIcons[type]}\n        </div>\n        <div className=\"text-sm\">\n          {children}\n        </div>\n      </Row>\n    </div>\n  );\n};\n\nexport default Alert;\n","import React, { ErrorInfo } from 'react';\nimport Alert, { ErrorAlert } from './Alert';\n\ntype Props = {\n  children: React.ReactNode,\n};\n\ntype State = {\n  hasError: boolean,\n};\n\nclass ErrorBoundary extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n    };\n  }\n\n  static getDerivedStateFromError(): State {\n    // Update state so the next render will show the fallback UI.\n    return {\n      hasError: true,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    // You can also log the error to an error reporting service.\n    // eslint-disable-next-line no-console\n    console.error(error, errorInfo);\n    this.setState({ hasError: true });\n  }\n\n  render(): React.ReactNode {\n    const { children } = this.props;\n    const { hasError } = this.state;\n\n    if (hasError) {\n      // You can render any custom fallback UI\n      return (\n        <Alert type={ErrorAlert}>\n          Component has crashed\n        </Alert>\n      );\n    }\n\n    return children;\n  }\n}\n\nexport default ErrorBoundary;\n","import React from 'react';\nimport ErrorBoundary from './ErrorBoundary';\n\ntype InteractivePostAreaProps = {\n  children: React.ReactNode,\n  title?: string | null,\n  className?: string,\n};\n\nconst InteractivePostArea = (props: InteractivePostAreaProps): React.ReactElement | null => {\n  const { children, title, className = '' } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  const titleElement = title ? (\n    <div className=\"text-xs font-light\">\n      {title}\n    </div>\n  ) : null;\n\n  return (\n    <ErrorBoundary>\n      {titleElement}\n      <div className={`p-6 border border-dashed border-gray-300 rounded-md overflow-hidden ${className}`}>\n        {children}\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nexport default InteractivePostArea;\n","import React from 'react';\n\nimport type { Link as LinkType } from '../types/Link';\n\nexport type HyperLinkProps = {\n  link: LinkType,\n  children: React.ReactNode,\n  className?: string,\n  hoverClassName?: string | null | undefined,\n  startEnhancer?: React.ReactNode,\n  formatted?: boolean,\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void,\n};\n\nconst HyperLink = (props: HyperLinkProps): React.ReactElement | null => {\n  const {\n    link,\n    children,\n    className = '',\n    hoverClassName = null,\n    startEnhancer = null,\n    formatted = true,\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onClick = (): void => {},\n  } = props;\n\n  if (!link?.url) {\n    return null;\n  }\n\n  const hoverClasses = hoverClassName || 'hover:text-red-600';\n\n  const commonClasses = formatted\n    ? `transition duration-200 ease-in-out whitespace-nowrap flex flex-row items-center ${hoverClasses}`\n    : '';\n\n  const caption = link?.caption || undefined;\n\n  const separator = startEnhancer ? (\n    <span className=\"w-1\" />\n  ) : null;\n\n  return (\n    <a\n      href={link.url}\n      className={`${commonClasses} ${className}`}\n      onClick={onClick}\n      title={caption}\n      style={{ fontWeight: 400 }}\n    >\n      {formatted && startEnhancer}\n      {formatted && separator}\n      {children}\n    </a>\n  );\n};\n\nexport default HyperLink;\n","import React from 'react';\nimport ImageResizer from './ImageResizer';\nimport RootLayout from './RootLayout';\nimport PageLayout from './PageLayout';\nimport InteractivePostArea from './InteractivePostArea';\nimport { gitHubRepoURL, seamCarvingBlogPostURL, seamCarvingPaperURL } from '../constants/links';\nimport HyperLink from './HyperLink';\nimport { AiFillGithub } from '@react-icons/all-files/ai/AiFillGithub';\nimport { brandName } from '../constants/siteMeta';\nimport { FaPencilAlt } from '@react-icons/all-files/fa/FaPencilAlt';\nimport { RiFileList2Line } from '@react-icons/all-files/ri/RiFileList2Line';\n\nfunction App() {\n  const algorithmBlogPostLink = (\n    <HyperLink\n      className=\"inline-flex ml-1\"\n      link={{ url: seamCarvingBlogPostURL }}\n      startEnhancer={<FaPencilAlt size={13} />}\n    >\n      How it works\n    </HyperLink>\n  );\n\n  const gitHubLink = (\n    <HyperLink\n      className=\"inline-flex ml-1\"\n      link={{ url: gitHubRepoURL }}\n      startEnhancer={(<AiFillGithub size={16} />)}\n    >\n      Source-code\n    </HyperLink>\n  );\n\n  const algorithmPaperLink = (\n    <HyperLink\n      className=\"inline-flex ml-1\"\n      link={{ url: seamCarvingPaperURL }}\n      startEnhancer={(<RiFileList2Line size={14} />)}\n    >\n      Seam carving paper\n    </HyperLink>\n  );\n\n  return (\n    <RootLayout>\n      <PageLayout>\n        <div className=\"flex flex-col items-center\">\n          <article className=\"w-full prose prose-sm sm:prose overflow-hidden\" style={{ maxWidth: '860px' }}>\n            <div className=\"flex flex-col md:flex-row md:items-center mb-6\">\n              <h1 className=\"uppercase\" style={{ margin: '0 20px 0 0' }}>{brandName}</h1>\n              <h4 className=\"uppercase\" style={{ margin: 0 }}>Content-aware image resizer</h4>\n            </div>\n            <div className=\"text-xs text-gray-500 mb-4 font-light flex items-center flex-row flex-wrap\">\n              <div className=\"flex flex-row justify-center mb-3 mr-4 md:mr-6\">\n                {algorithmBlogPostLink}\n              </div>\n              <div className=\"flex flex-row justify-center mb-3 mr-4 md:mr-6\">\n                {gitHubLink}\n              </div>\n              <div className=\"flex flex-row justify-center mb-3\">\n                {algorithmPaperLink}\n              </div>\n            </div>\n            <InteractivePostArea>\n              <ImageResizer withSeam />\n            </InteractivePostArea>\n          </article>\n        </div>\n      </PageLayout>\n    </RootLayout>\n  );\n}\n\nexport default App;\n","export const gitHubRepoURL = 'https://github.com/trekhleb/js-image-carver';\nexport const seamCarvingPaperURL = 'https://perso.crans.org/frenoy/matlab2012/seamcarving.pdf';\nexport const seamCarvingBlogPostURL = 'https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/';\n","export const brandName = 'JS Image Carver';\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}